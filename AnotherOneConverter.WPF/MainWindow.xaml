<Window x:Class="AnotherOneConverter.WPF.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:AnotherOneConverter.WPF"
        mc:Ignorable="d"
        DataContext="{Binding Main, Source={StaticResource Locator}}"
        Title="PDF Converter" MinHeight="480" MinWidth="640" Height="480" Width="640">
    <Window.Resources>
        <ResourceDictionary>
            <ImageBrush x:Key="TabCloseButtonImageBrush" ImageSource="Assets/close_window_1_96px.png"></ImageBrush>

            <ImageBrush x:Key="TabCloseButtonHoverImageBrush" ImageSource="Assets/close_window_2_96px.png"></ImageBrush>

            <ImageBrush x:Key="TabCloseButtonActiveImageBrush" ImageSource="Assets/close_window_3_96px.png"></ImageBrush>

            <Style x:Key="TabCloseButtonStyle" TargetType="Button">
                <Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Setter Property="Background" Value="{StaticResource TabCloseButtonHoverImageBrush}"></Setter>
                    </Trigger>
                    <Trigger Property="IsPressed" Value="True">
                        <Setter Property="Background" Value="{StaticResource TabCloseButtonActiveImageBrush}"></Setter>
                    </Trigger>
                </Style.Triggers>

                <Setter Property="OverridesDefaultStyle" Value="True"></Setter>
                <Setter Property="Background" Value="{StaticResource TabCloseButtonImageBrush}"></Setter>
                <Setter Property="Width" Value="16"></Setter>
                <Setter Property="Height" Value="16"></Setter>
                <Setter Property="Padding" Value="0"></Setter>
                <Setter Property="Margin" Value="4,0,0,0"></Setter>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Border Background="{TemplateBinding Background}">
                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"></ContentPresenter>
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            
            <DataTemplate x:Key="ProjectHeaderTemplate">
                <DockPanel>
                    <Button DockPanel.Dock="Right" Style="{StaticResource TabCloseButtonStyle}" Command="{Binding Close}"></Button>

                    <ContentPresenter Content="{Binding DisplayName}"></ContentPresenter>
                </DockPanel>
            </DataTemplate>

            <DataTemplate x:Key="ProjectContentTemplate">
                <DataGrid
                    ItemsSource="{Binding Documents}"
                    AutoGenerateColumns="False"
                    CanUserAddRows="False"
                    CanUserReorderColumns="False"
                    CanUserResizeRows="False"
                    HeadersVisibility="Column">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="File Name" Binding="{Binding FileName, Mode=OneWay}"></DataGridTextColumn>
                        <DataGridTextColumn Header="Changed" Binding="{Binding LastWriteTime, StringFormat=g, Mode=OneWay}"></DataGridTextColumn>
                    </DataGrid.Columns>
                </DataGrid>
            </DataTemplate>
        </ResourceDictionary>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" MinHeight="20px"></RowDefinition>
            <RowDefinition></RowDefinition>
            <RowDefinition Height="Auto" MinHeight="20px"></RowDefinition>
        </Grid.RowDefinitions>

        <Menu>
            <MenuItem Header="File">
                <MenuItem Header="Open File..." Command="{Binding ActiveProject.OpenFile}"></MenuItem>
                <MenuItem Header="Save">
                    <MenuItem.Icon>
                        <Image Source="Assets/save_96px.png"></Image>
                    </MenuItem.Icon>
                </MenuItem>
                <MenuItem Header="Save As..."></MenuItem>
                <MenuItem Header="Save and Split"></MenuItem>
                <Separator></Separator>
                <MenuItem Header="Exit">
                    <MenuItem.Icon>
                        <Image Source="Assets/exit_96px.png"></Image>
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>
            <MenuItem Header="Project">
                <MenuItem Header="New Project" Command="{Binding CreateProject}"></MenuItem>
                <MenuItem Header="Open Project..."></MenuItem>
                <Separator></Separator>
                <MenuItem Header="Save Project"></MenuItem>
                <MenuItem Header="Save Project As .."></MenuItem>
                <MenuItem Header="Close Project" Command="{Binding ActiveProject.Close}"></MenuItem>
            </MenuItem>
        </Menu>

        <TabControl
            Grid.Row="1"
            SelectedItem="{Binding ActiveProject, Mode=TwoWay}"
            ItemsSource="{Binding Projects}"
            ItemTemplate="{StaticResource ProjectHeaderTemplate}"
            ContentTemplate="{StaticResource ProjectContentTemplate}">
        </TabControl>

        <StatusBar Grid.Row="2">
            <ProgressBar Visibility="Hidden"></ProgressBar>
        </StatusBar>
    </Grid>
</Window>
